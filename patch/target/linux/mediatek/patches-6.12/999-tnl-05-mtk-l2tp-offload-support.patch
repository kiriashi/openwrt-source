--- a/net/l2tp/l2tp_core.c
+++ b/net/l2tp/l2tp_core.c
@@ -1231,6 +1231,10 @@ static int l2tp_xmit_core(struct l2tp_se
 	struct inet_sock *inet;
 	struct udphdr *uh;
 
+#if IS_ENABLED(CONFIG_NF_FLOW_TABLE)
+	skb_reset_inner_headers(skb);
+#endif
+
 	/* Check that there's enough headroom in the skb to insert IP,
 	 * UDP and L2TP headers. If not enough, expand it to
 	 * make room. Adjust truesize.
--- a/net/l2tp/l2tp_ppp.c
+++ b/net/l2tp/l2tp_ppp.c
@@ -333,6 +333,7 @@ static int l2tp_ppp_flow_offload_check(s
 		return -EINVAL;
 
 	path->flags |= BIT(DEV_PATH_TNL);
+	path->tnl_type = FLOW_OFFLOAD_TNL_L2TP_V2;
 
 	l2tp_session_put(session);
 
